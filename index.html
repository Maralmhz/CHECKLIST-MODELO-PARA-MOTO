<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#e41616">
    <title>Checklist Motos - Oficina</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="theme.css">
    <link rel="stylesheet" href="wizard.css">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img id="logo-oficina" src="logo.png" alt="Logo">
            </div>
            <div class="header-content">
                <h1 id="nome-oficina">OFICINA DE MOTOS</h1>
                <p id="subtitulo-oficina">Checklist de Motocicletas</p>
                <div class="contato-info">
                    <span id="telefone-oficina">(00) 00000-0000</span>
                </div>
                <div id="endereco-oficina">Endere√ßo da Oficina</div>
                <div id="cnpj-oficina">CNPJ: 00.000.000/0000-00</div>
                <div class="status-sync">
                    <div class="sync-dot" id="syncStatus"></div>
                    <span id="syncText">Online</span>
                </div>
            </div>
            <div class="header-badge">v3.0 MOTOS</div>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('novo-checklist')">‚ûï Novo</button>
            <button class="tab-button" onclick="switchTab('orcamento')">üí∞ Or√ßamento</button>
            <button class="tab-button" onclick="switchTab('fotos')">üì∏ Fotos</button>
            <button class="tab-button" onclick="switchTab('resumo'); atualizarResumoOS()">üìÑ Resumo</button>
            <button class="tab-button" onclick="switchTab('historico')">üìã Hist√≥rico</button>
        </div>

        <div class="os-info-bar">
            <div>üèçÔ∏è ORDEM DE SERVI√áO</div>
            <div id="barraFixaOS">-</div>
        </div>

        <!-- ABA NOVO CHECKLIST -->
        <div id="novo-checklist" class="tab-content active">
            <div class="content">
                <div id="successMessage" class="alert alert-success"></div>
                <div id="errorMessage" class="alert alert-error"></div>
                <div id="infoMessage" class="alert alert-info"></div>

                <form id="checklistForm" class="wizard-form">
                    <div class="section-title">üèçÔ∏è INFORMA√á√ïES DA MOTO</div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="placa">Placa *</label>
                            <input type="text" id="placa" name="placa" placeholder="ABC-1234" required>
                        </div>
                        <div class="form-group">
                            <label for="chassi">Chassi</label>
                            <input type="text" id="chassi" name="chassi">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="modelo">Modelo</label>
                            <input type="text" id="modelo" name="modelo" placeholder="Ex: Honda CG 160">
                        </div>
                        <div class="form-group">
                            <label for="kmentrada">KM Entrada</label>
                            <input type="text" id="kmentrada" name="kmentrada">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="data">Data</label>
                            <input type="date" id="data" name="data">
                        </div>
                        <div class="form-group">
                            <label for="hora">Hora</label>
                            <input type="time" id="hora" name="hora">
                        </div>
                    </div>

                    <div class="section-title">üîç INSPE√á√ÉO DA MOTO</div>

                    <div class="equip-section">
                        <div class="equip-section-title">üîß ITENS DE SEGURAN√áA</div>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="retrovisores" name="equipamentos" value="RETROVISORES">
                                <label for="retrovisores">Retrovisores</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="farol" name="equipamentos" value="FAROL">
                                <label for="farol">Farol/Lanterna</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="buzina" name="equipamentos" value="BUZINA">
                                <label for="buzina">Buzina</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="setas" name="equipamentos" value="SETAS">
                                <label for="setas">Setas/Piscas</label>
                            </div>
                        </div>
                    </div>

                    <div class="equip-section">
                        <div class="equip-section-title">‚öôÔ∏è MEC√ÇNICO</div>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="corrente" name="equipamentos" value="CORRENTE">
                                <label for="corrente">Corrente/Rela√ß√£o</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="freio_d" name="equipamentos" value="FREIO DIANTEIRO">
                                <label for="freio_d">Freio Dianteiro</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="freio_t" name="equipamentos" value="FREIO TRASEIRO">
                                <label for="freio_t">Freio Traseiro</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="suspensao" name="equipamentos" value="SUSPENS√ÉO">
                                <label for="suspensao">Suspens√£o</label>
                            </div>
                        </div>
                    </div>

                    <div class="equip-section">
                        <div class="equip-section-title">üõû PNEUS</div>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="pneu_d" name="equipamentos" value="PNEU DIANTEIRO OK">
                                <label for="pneu_d">Pneu Dianteiro OK</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="pneu_t" name="equipamentos" value="PNEU TRASEIRO OK">
                                <label for="pneu_t">Pneu Traseiro OK</label>
                            </div>
                        </div>
                    </div>

                    <div class="equip-section">
                        <div class="equip-section-title">üì¶ ACESS√ìRIOS</div>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="bau" name="equipamentos" value="BA√ö">
                                <label for="bau">Ba√∫</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="protetor" name="equipamentos" value="PROTETOR MOTOR">
                                <label for="protetor">Protetor Motor</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="manoplas" name="equipamentos" value="MANOPLAS">
                                <label for="manoplas">Manoplas</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="obsInspecao">Observa√ß√µes</label>
                        <textarea id="obsInspecao" name="obsInspecao" rows="3"></textarea>
                    </div>

                    <div class="section-title">üë§ CLIENTE</div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="nomecliente">Nome do Cliente</label>
                            <input type="text" id="nomecliente" name="nomecliente">
                        </div>
                        <div class="form-group">
                            <label for="celular">Celular/WhatsApp</label>
                            <input type="tel" id="celular" name="celular">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="servicos">Servi√ßos Solicitados</label>
                        <textarea id="servicos" name="servicos" rows="3"></textarea>
                    </div>
                </form>
            </div>
        </div>

        <!-- ABA OR√áAMENTO -->
        <div id="orcamento" class="tab-content">
            <div class="content">
                <div class="section-title">üí∞ PE√áAS & SERVI√áOS</div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Tipo:</label>
                        <div>
                            <input type="radio" id="tipoPeca" name="tipoItem" value="peca" checked>
                            <label for="tipoPeca">Pe√ßa</label>
                            <input type="radio" id="tipoServico" name="tipoItem" value="servico">
                            <label for="tipoServico">Servi√ßo</label>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="descricaoItem">Descri√ß√£o</label>
                        <input type="text" id="descricaoItem" placeholder="Ex: √ìleo 20W50">
                    </div>
                    <div class="form-group">
                        <label for="valorItem">Valor (R$)</label>
                        <input type="number" id="valorItem" step="0.01" min="0">
                    </div>
                </div>

                <button type="button" class="btn-primary" onclick="adicionarItemManual()">‚ûï Adicionar</button>

                <h4>üî© Pe√ßas</h4>
                <table style="width:100%; border-collapse:collapse;">
                    <thead>
                        <tr>
                            <th>Descri√ß√£o</th>
                            <th>Valor</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaPecas"></tbody>
                    <tfoot>
                        <tr>
                            <td><strong>Total Pe√ßas:</strong></td>
                            <td id="totalPecas"><strong>R$ 0,00</strong></td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>

                <h4>üîß Servi√ßos</h4>
                <table style="width:100%; border-collapse:collapse;">
                    <thead>
                        <tr>
                            <th>Descri√ß√£o</th>
                            <th>Valor</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tabelaServicos"></tbody>
                    <tfoot>
                        <tr>
                            <td><strong>Total Servi√ßos:</strong></td>
                            <td id="totalServicos"><strong>R$ 0,00</strong></td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>

                <div style="text-align:right; margin-top:20px;">
                    <h3>TOTAL GERAL: <span id="totalGeralFinal">R$ 0,00</span></h3>
                </div>

                <button class="btn-success" onclick="switchTab('resumo'); atualizarResumoOS()">üìÑ Ver Resumo</button>
            </div>
        </div>

        <!-- ABA FOTOS -->
        <div id="fotos" class="tab-content">
            <div class="content">
                <div class="section-title">üì∏ FOTOS DA MOTO</div>
                
                <button class="btn-primary" onclick="iniciarCamera()">üì∑ Tirar Foto</button>
                <input type="file" id="uploadFotos" multiple accept="image/*" onchange="adicionarFotos(event)" style="display:none;">
                <button class="btn-secondary" onclick="document.getElementById('uploadFotos').click()">üìÅ Galeria</button>

                <div class="camera-container" style="display:none;">
                    <video id="cameraPreview" autoplay playsinline style="width:100%; max-width:400px;"></video>
                    <button class="btn-success" onclick="tirarFoto()" id="btnTirarFoto">üì∏ Capturar</button>
                    <button class="btn-secondary" onclick="pararCamera()">‚ùå Cancelar</button>
                </div>

                <div id="galeriaFotos" class="fotos-grid"></div>

                <button class="btn-danger" onclick="limparFotos()">üóëÔ∏è Limpar Fotos</button>
            </div>
        </div>

        <!-- ABA RESUMO -->
        <div id="resumo" class="tab-content">
            <div class="content">
                <div id="resumoContainer" class="os-paper">
                    <div class="os-header">
                        <img id="logoResumo" src="logo.png" alt="Logo" style="width:80px;">
                        <div>
                            <h2 id="nomeOficinaResumo">OFICINA DE MOTOS</h2>
                            <p id="enderecoOficinaResumo"></p>
                            <p id="telefoneOficinaResumo"></p>
                            <p id="cnpjOficinaResumo"></p>
                        </div>
                        <div>
                            <h3>OS N¬∫ <span id="osNumero"></span></h3>
                        </div>
                    </div>

                    <h3>CLIENTE</h3>
                    <p><strong>Nome:</strong> <span id="rNomeCliente"></span></p>
                    <p><strong>Celular:</strong> <span id="rCelular"></span></p>

                    <h3>MOTOCICLETA</h3>
                    <p><strong>Modelo:</strong> <span id="rModelo"></span></p>
                    <p><strong>Placa:</strong> <span id="rPlaca"></span></p>
                    <p><strong>KM:</strong> <span id="rKmEntrada"></span></p>

                    <h3>SERVI√áOS SOLICITADOS</h3>
                    <p id="rServicos"></p>

                    <h3>INSPE√á√ÉO</h3>
                    <div id="rChecklistBadges"></div>

                    <h3>OBSERVA√á√ïES</h3>
                    <p id="rObsInspecao"></p>

                    <div style="page-break-before:always;"></div>

                    <h3>PE√áAS</h3>
                    <table id="rTabelaPecas" style="width:100%;"></table>
                    <p><strong>Total Pe√ßas:</strong> <span id="rTotalPecas"></span></p>

                    <h3>SERVI√áOS</h3>
                    <table id="rTabelaServicos" style="width:100%;"></table>
                    <p><strong>Total Servi√ßos:</strong> <span id="rTotalServicos"></span></p>

                    <h2>TOTAL GERAL: <span id="rTotalGeral"></span></h2>

                    <div style="margin-top:50px;">
                        <div style="display:inline-block; width:45%; text-align:center; border-top:1px solid #000;">
                            Assinatura Cliente
                        </div>
                        <div style="display:inline-block; width:45%; text-align:center; border-top:1px solid #000; margin-left:5%;">
                            Assinatura T√©cnico
                        </div>
                    </div>
                </div>

                <button class="btn-secondary" onclick="imprimirResumo()">üñ®Ô∏è Imprimir</button>
                <button class="btn-success" onclick="gerarPDFResumo()">üì• PDF</button>
                <button class="btn-primary" onclick="salvarChecklist()">üíæ Salvar</button>
            </div>
        </div>

        <!-- ABA HIST√ìRICO -->
        <div id="historico" class="tab-content">
            <div class="content">
                <input type="text" id="searchInput" placeholder="üîç Buscar..." style="width:100%; padding:10px; margin-bottom:20px;">
                <div id="checklistsList"></div>
                <div id="emptyMessage" style="text-align:center; padding:40px; display:none;">
                    <p>üìã Nenhum checklist ainda</p>
                </div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="app.js"></script>
    <script src="firebase.js"></script>
    <script src="main.js"></script>
    <script src="orcamento.js"></script>
    <script src="resumo-veiculo.js"></script>
    <script src="fotos.js"></script>
    <script src="resumo.js"></script>
    <script src="form-nav.js"></script>
    <script src="wizard.js"></script>
</body>
</html>